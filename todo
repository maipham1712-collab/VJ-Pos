# VJ¬∑POS ‚Äî TODO

## ‚úÖ Completed

- [x] Mobile-first POS interface (iPhone optimized)
- [x] PIN-based staff login with role-based access
- [x] Product search, category/brand filtering
- [x] Shopping cart with quantity adjustment and price editing
- [x] Per-item discounts (fixed or %)
- [x] Bill-level discounts (fixed or %)
- [x] Card fee toggle (3%), shipping fee
- [x] Order submission to Google Sheets
- [x] Order history with payment status (paid/partial/unpaid)
- [x] Payment recording (cash, POS/card, transfer, PayPal)
- [x] Order voiding with stock restoration (admin only)
- [x] Commission calculation by vendor type
- [x] Bulk stock import (admin)
- [x] Standardized 50K/90K VND price endings
- [x] **Top button spacing** ‚Äî safe area inset for iPhone notch/Dynamic Island
- [x] **Draft orders** ‚Äî staff can work on multiple orders, switch between them
- [x] **Orders badge** ‚Äî shows unpaid order count (not total orders)

## üêõ Open Bugs

### Search bar not sticky (HIGH PRIORITY)
The search bar and category/brand filters on the Products tab scroll away with the product grid. They should stay pinned below the VJ¬∑POS header so staff can search/filter without scrolling back to the top.

**What was tried:**
1. `position: sticky` on a wrapper div inside `.main` ‚Äî did not work (likely because `.main` uses `overflow-y: auto` in a flex layout)
2. Moving the search bar outside `.main` as a flex sibling with `flex-shrink: 0` ‚Äî did not work (unclear why)
3. `position: fixed` with dynamic `top` calculated via `useRef` ‚Äî not yet verified on device

**App structure (relevant):**
```
.app (flex column, max-width 430px, min-height 100dvh)
  .top (position: fixed, z-index 50) ‚Äî VJ¬∑POS header
  .search-sticky (position: fixed, z-index 49, top: [headerHeight]) ‚Äî search + filters
  .main (flex: 1, overflow-y: auto, padding-top: dynamic) ‚Äî scrollable content
  .tabs (position: fixed, bottom: 0) ‚Äî tab bar
```

**Notes for debugging:**
- The bottom `.tabs` bar uses `position: fixed` and works perfectly ‚Äî search bar should use same approach
- Test on iPhone Safari (primary device) ‚Äî CSS behavior may differ from desktop Chrome
- The `top` value for `.search-sticky` is set dynamically via JS measuring `.top`'s offsetHeight
- `.main` padding-top is also set dynamically to push content below both fixed elements
- Check if `useRef` + `useEffect` measurement is running correctly (heights might be 0 on first render)

## üìã Planned Features

### Consignment Receiving Workflow
- Staff photographs new artist inventory
- Artist remotely inputs wholesale pricing
- Staff adds product names (no cost visibility)
- Mai approves final retail pricing
- Auto-insert into POS catalog

### Hot Choco AI Accountant
- Telegram bot querying real-time POS data
- Daily/weekly sales summaries
- Natural language queries ("how much did we sell today?")

### Mobile App Conversion
- Evaluate Glide/Adalo for native-feeling app
- Real-time sync with Google Sheets
- Offline capability, push notifications

### Future
- Customer database / CRM
- Digital receipts (Telegram/email)
- Low-stock alerts
- Sales analytics dashboard
